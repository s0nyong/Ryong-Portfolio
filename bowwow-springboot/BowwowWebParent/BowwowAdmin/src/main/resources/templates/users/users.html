<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org">
   
<head th:replace="fragments :: page_head('Users - Bowwow Admin')"/>

<body>
   
<div class="container-fluid">
   <div th:replace="navigation :: menu"></div>
   		<div class="container">
		   <div>
		      	<h1 style="color: darkgrey;">Bowwow Users</h1>     	
		   </div>
		      
		   <div>
			   <div style="float: right;">
				   <a th:href="@{/users/user_form}" >
				     <button style="border-radius: 5px; background-color: darkgray; color:white; 
			     	border: none; width: 100%;height: 40px;">&nbsp;Create New User&nbsp; </button>
				   </a>
			   	</div>
			   	
			   <form th:action="@{/users/page/1}" class="form-inline m-3">
				   <input type="hidden" name="sortField" th:value="${sortField}"/>
				   <input type="hidden" name="sortDir" th:value="${sortDir}"/>
				   Filter:&nbsp;
		   			<input type="search" name="keyword" th:value="${keyword}" class="form-control" required/>
		   			&nbsp;&nbsp;
		   			<input type="submit" value="Search" style="border-radius: 5px; background-color: darkgray; color:white; 
			     	border: none; height: 40px;"/>
					&nbsp;&nbsp;
					<input type="button" value="Clear" style="border-radius: 5px; background-color: darkgray; color:white; 
			     	border: none; height: 40px;" onclick="clearFilter()"/>
			  	</form>
		  	</div>
   
   			<div class="full-details">
			   <table class="table table-striped">
			      <thead>
			       <tr>
			            <th>
				         	<a th:if="${sortField != 'id'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=id&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               User ID
				            </a>
				            <a th:if="${sortField == 'id'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=id&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               User ID
				            </a>
				            <span th:if="${sortField == 'id'}"
				               th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
				            </span>
			         	</th>
			            
			         	<th>
				         	<a th:if="${sortField != 'name'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=name&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               Name
				            </a>
				            <a th:if="${sortField == 'name'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=name&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               Name
				            </a>
				             <span th:if="${sortField == 'name'}"
				               th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
				            </span>
			         	</th>
			            <th>
					        <a th:if="${sortField != 'nickName'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=nickName&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               NickName
				            </a>
				            <a th:if="${sortField == 'nickName'}" class="text-white" 
				              th:href="@{'/users/page/' + ${currentPage} + '?sortField=nickName&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				              NickName
				            </a>
				            <span th:if="${sortField == 'nickName'}"
				               th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
				            </span>
			         	</th>
			            <th>
			         		<a th:if="${sortField != 'email'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=email&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               Email
				            </a>
				            <a th:if="${sortField == 'email'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=email&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               Email
				            </a>
				            <span th:if="${sortField == 'email'}"
				               th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
				            </span>
			         	</th>
			            <th>
			         		<a th:if="${sortField != 'phone'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=phone&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				               Phone
				            </a>
				            <a th:if="${sortField == 'phone'}" class="text-white" 
				               th:href="@{'/users/page/' + ${currentPage} + '?sortField=phone&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				              Phone
				            </a>
				            <span th:if="${sortField == 'phone'}"
				               th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
				            </span>
			         	</th>
			            <th>
			            	<a th:if="${sortField != 'address'}" class="text-white" 
			                 	th:href="@{'/users/page/' + ${currentPage} + '?sortField=address&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                  	Address
			                </a>
				            <a th:if="${sortField == 'address'}" class="text-white" 
				                th:href="@{'/users/page/' + ${currentPage} + '?sortField=address&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
				                Address
				            </a>
				            <span th:if="${sortField == 'address'}"
				               th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
				            </span>
			         	</th>
			            <th>
			            <a th:if="${sortField != 'point'}" class="text-white" 
			                 th:href="@{'/users/page/' + ${currentPage} + '?sortField=point&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                  Point
			                 </a>
			               <a th:if="${sortField == 'point'}" class="text-white" 
			                  th:href="@{'/users/page/' + ${currentPage} + '?sortField=point&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                 Point
			                 </a>
			                 <span th:if="${sortField == 'point'}"
			                  th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
			               </span>
			         </th>
			            <th>
			            <a th:if="${sortField != 'role'}" class="text-white" 
			                 th:href="@{'/users/page/' + ${currentPage} + '?sortField=role&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                  Role
			                 </a>
			               <a th:if="${sortField == 'role'}" class="text-white" 
			                  th:href="@{'/users/page/' + ${currentPage} + '?sortField=role&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                 Role
			                 </a>
			                 <span th:if="${sortField == 'role'}"
			                  th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
			               </span>
			         </th>
			            <th>
			         <a th:if="${sortField != 'enabled'}" class="text-white" 
			                 th:href="@{'/users/page/' + ${currentPage} + '?sortField=enabled&sortDir=' + ${sortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                  Enabled
			                 </a>
			               <a th:if="${sortField == 'enabled'}" class="text-white" 
			                  th:href="@{'/users/page/' + ${currentPage} + '?sortField=enabled&sortDir=' + ${reverseSortDir} + ${keyword !=null ? '&keyword=' + keyword : ''}}">
			                 Enabled
			                </a>
			                 <span th:if="${sortField == 'enabled'}"
			                  th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}">
			               </span>
			         </th>
			            <th></th>
			         </tr>
			         </thead>
			      <tbody>
			         <tr th:each="user:${listUsers}">
			         <td>[[${user.id}]]</td> 
			         <td>[[${user.name}]]</td> 
			         <td>[[${user.nickName}]]</td>
			            <td>[[${user.email}]]</td>   
			            <td>[[${user.phone}]]</td>  
			            <td>[[${user.address}]]</td>
			            <td>[[${user.point}]]</td>
			            <td>[[${user.role}]]</td>
			            <td>[[${user.enabled}]]</td>
			            <td>
			            <a th:href="@{'/users/edit/' + ${user.id}}" title="Edit this user" class="fa-regular fa-pen-to-square fa-2x icon-darkgray"></a>
			            &nbsp;
			              <!-- <a class="fa-solid fa-trash fa-2x icon-silver link-delete" th:href="@{'/users/delete/' + ${user.id}}" th:userId="${user.id}" title="Delete this user"></a>-->
			            </td>
			        </tr>
			        </tbody> 	         	    
			   </table>
			   <div th:if="${listUsers.isEmpty()}">
				   <p style="text-align: center;">검색결과가 없습니다.</p>
			   </div>
   			</div>
   			
   		</div>
   		
   		
    <div class="modal fade text-center" id="confirmModal">
	   <div class="modal-dialog">
	      <div class="modal-content">
	         <div class="modal-header">
	            <h4 class="modal-title">Delete Confirmation</h4>
	            <button type="button" class="close" data-dismiss="modal">&times;</button>
	         </div>
	         
	         <div class="modal-body">
	            <span id="confirmText"></span>
	         </div>
	         
	         
	         <div class="modal-footer">
	            <a class="btn btn-sucess" href="" id="yesButton">Yes</a>
	            <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
	         </div>
	      </div>
	   </div>
	</div>
    
   <div th:if="${totalPages > 1}">
    <nav>
        <ul class="pagination justify-content-center">
            <li th:class="${currentPage == 1 ? 'page-item disabled' : 'page-item'}">
                <a class="page-link" th:href="@{'/users/page/1?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">First</a>
            </li>

            <li th:class="${currentPage > 1 ? 'page-item active' : 'page-item disabled'}">
                <a class="page-link" th:href="@{'/users/page/' + ${currentPage - 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">Previous</a>
            </li>

            <li th:class="${i == currentPage ? 'page-item active' : 'page-item'}" th:each="i:${#numbers.sequence(1,totalPages)}">
                <a class="page-link" th:href="@{'/users/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}" th:text="${i}">1</a>
            </li>

            <li th:class="${currentPage < totalPages ? 'page-item active' : 'page-item disabled'}">
                <a class="page-link" th:href="@{'/users/page/' + ${currentPage + 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">Next</a>
            </li>

            <li th:class="${currentPage == totalPages ? 'page-item disabled' : 'page-item'}">
                <a class="page-link" th:href="@{'/users/page/' + ${totalPages} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">Last</a>
            </li>
        </ul>
    </nav>
   </div>
         
      <div th:replace="fragments :: footer"></div>
</div>   
</div>
<script type="text/javascript">
   $(document).ready(function(){
      $(".link-delete").on("click", function(e){
         e.preventDefault();
         link = $(this);
         userId = link.attr("userId");
         $("#yesButton").attr("href", link.attr("href"));
         $("#confirmText").text("Are you sure you want to delete this user ID " + userId + "?");
         $("#confirmModal").modal();
      });
   });
   function clearFilter(){
   window.location = "[[@{/users}]]";
}
   
</script>
</body>
</html>