<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org">
	
<head th:replace="fragments :: page_head('Products - Bowwow Admin')"/>

<body>
	
	<div class="container-fluid">
		<div th:replace="navigation :: menu"></div>
		<div class="container">
			
			<div style="float: right;">
			   <a th:href="@{/product/new}" >
			     <button style="border-radius: 5px; background-color: darkgray; color:white; 
			     	border: none; width: 100%;height: 40px;">
			     	&nbsp;Create New Product&nbsp;
			     </button> 
			   </a>
		   </div>
		   
		   <div>
		      <h1 style="color: darkgrey;">Manage Product</h1>
		   </div>
		   
		   
	   
		   <div th:if = "${message != null}" class="alert alert-success text-center">
		   		[[${message}]]
		   </div>
	   
	   
		   <div class="full-details">
			   <table class="table table-striped">
			      <thead style="background-color: darkgray;">
                <tr>
                  <th class="text-white" style="width: 11%;">image</th>
                  <th style="width: 13%;">
                     <a th:if="${sortField != 'mainName'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=mainName&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     MainName
                     </a>
                     <a th:if="${sortField == 'mainName'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=mainName&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     MainName
                     </a>
                     <span th:if="${sortField == 'mainName'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                     <th style="width: 13%;">
                     <a th:if="${sortField != 'subName'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=subName&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     SubName
                     </a>
                     <a th:if="${sortField == 'subName'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=subName&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     SubName
                     </a>
                     <span th:if="${sortField == 'subName'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                     <th style="width: 10%;">
                     <a th:if="${sortField != 'brand'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=brand&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Brand
                     </a>
                     <a th:if="${sortField == 'brand'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=brand&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Brand
                     </a>
                     <span th:if="${sortField == 'brand'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                  <th style="width: 13%;">
                     <a th:if="${sortField != 'categoryId'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=categoryId&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Category
                     </a>
                     <a th:if="${sortField == 'categoryId'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=categoryId&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Category
                     </a>
                     <span th:if="${sortField == 'categoryId'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                     <th style="width: 10%;">
                     <a th:if="${sortField != 'price'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=price&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Price
                     </a>
                     <a th:if="${sortField == 'price'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=price&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Price
                     </a>
                     <span th:if="${sortField == 'price'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                     <th style="width: 10%;">
                     <a th:if="${sortField != 'discount'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=discount&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Discount
                     </a>
                     <a th:if="${sortField == 'discount'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=discount&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Discount
                     </a>
                     <span th:if="${sortField == 'discount'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                  <th style="width: 10%;">
                     <a th:if="${sortField != 'score'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=score&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Score
                     </a>
                     <a th:if="${sortField == 'score'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=score&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Score
                     </a>
                     <span th:if="${sortField == 'score'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                  <th style="width: 20%;">
                     <a th:if="${sortField != 'stock'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=stock&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Stock
                     </a>
                     <a th:if="${sortField == 'stock'}" class="text-white" 
                        th:href="@{'/product/page/' + ${currentPage} + '?sortField=stock&sortDir=' + ${reverseSortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">
                     Stock
                     </a>
                     <span th:if="${sortField == 'stock'}"
                        th:class="${sortDir == 'asc' ? 'fas fa-sort-up icon-white' : 'fas fa-sort-down icon-white'}"></span>
                  </th>
                     <th ></th>
                     </tr>
                  </thead>
			         
				      <tbody>
					   	<tr th:each="pro:${listproduct}">
							<td>
								<img th:src="@{${pro.mainImagePath}}" style="width:100px" class="img-fluid"/>
							</td> 
							<td>[[${pro.mainName}]]</td>   
				            <td>[[${pro.subName}]]</td>
				            <td>[[${pro.brand}]]</td>
				            <td>[[${pro.categoryId}]]</td>
				            <td>[[${pro.price}]]</td>
				            <td>[[${pro.discount}]]</td> 
				            <td>[[${pro.score}]]</td>
				            <td>[[${pro.stock}]]</td>           
				            <td>
								<a th:href="@{'/product/edit/' + ${pro.id}}" title="Edit this product" class="fa-regular fa-pen-to-square fa-2x icon-darkgray"></a>
								&nbsp;
				            	<a class="fa-solid fa-trash fa-2x icon-silver link-delete" th:href="@{'/product/delete/' + ${pro.id}}" th:productId="${pro.id}" title="Delete this product"></a>
				            </td>
				        </tr>
				      </tbody>      
			   </table>
		   </div>
	   </div>
	   </div>
	   
	    <div class="modal fade text-center" id="confirmModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Delete Confirmation</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				
				<div class="modal-body">
					<span id="confirmText"></span>
				</div>
				
				<div class="modal-footer">
					<a class="btn btn-sucess" href="" id="yesButton">Yes</a>
					<button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
				</div>
			</div>
		</div>
	</div>
			
	
	
	<div th:if="${totalPages > 1}">
    <nav>
        <ul class="pagination justify-content-center">
            <li th:class="${currentPage == 1 ? 'page-item disabled' : 'page-item'}">
                <a class="page-link" th:href="@{'/product/page/1?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">First</a>
            </li>

            <li th:class="${currentPage > 1 ? 'page-item active' : 'page-item disabled'}">
                <a class="page-link" th:href="@{'/product/page/' + ${currentPage - 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">Previous</a>
            </li>

            <li th:class="${i == currentPage ? 'page-item active' : 'page-item'}" th:each="i:${#numbers.sequence(1,totalPages)}">
                <a class="page-link" th:href="@{'/product/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}" th:text="${i}">1</a>
            </li>

            <li th:class="${currentPage < totalPages ? 'page-item active' : 'page-item disabled'}">
                <a class="page-link" th:href="@{'/product/page/' + ${currentPage + 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">Next</a>
            </li>

            <li th:class="${currentPage == totalPages ? 'page-item disabled' : 'page-item'}">
                <a class="page-link" th:href="@{'/product/page/' + ${totalPages} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir} + ${keyword != null ? '&keyword=' + keyword : ''}}">Last</a>
            </li>
        </ul>
    </nav>
	</div>
			
	<div th:replace="fragments :: footer"></div>
</div>   
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$(".link-delete").on("click", function(e){
			e.preventDefault();
			link = $(this);
			productId = link.attr("productId");
			$("#yesButton").attr("href", link.attr("href"));
			$("#confirmText").text("Are you sure you want to delete this product ID " + productId + "?");
			$("#confirmModal").modal();
		});
	});
	
	function clearFilter(){
			window.location = "[[@{/product}]]";
		}
	
</script>
</body>
</html>